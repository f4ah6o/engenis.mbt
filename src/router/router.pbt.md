<!-- aletheia:begin -->
# Property-Based Test Targets for router

> Auto-generated by Aletheia - MoonBit PBT Tool

## Overview

- **Source**: `/Users/fu2hito/src/moonbit/engenis.mbt-pbt/src/router`
- **Generated**: 2026-01-16
- **Patterns Detected**: 1

## Invariant Targets

- `PathParams::delete` (LengthDecreasing)

<!-- aletheia:end -->

---

# Property-Based Tests

## Package: router

### prop_pathparams_new_empty

Property: PathParams::new creates an empty params map

```mbt check
///|
test "prop_pathparams_new_empty" {
  let params = PathParams::new()
  assert_true(params.is_empty(), msg="new params should be empty")
}
```

### prop_pathparams_set_increases_length

Property: PathParams::set increases the number of parameters

```mbt check
///|
test "prop_pathparams_set_increases_length" {
  let params1 = PathParams::new()
  assert_true(params1.is_empty())

  let params2 = params1.set("key1", "value1")
  assert_true(!params2.is_empty())

  let params3 = params2.set("key2", "value2")
  assert_eq(params3.length(), 2)
}
```

### prop_pathparams_delete_decreases_length

Property: PathParams::delete decreases the number of parameters

```mbt check
///|
test "prop_pathparams_delete_decreases_length" {
  let params1 = PathParams::new()
    .set("key1", "value1")
    .set("key2", "value2")

  assert_eq(params1.length(), 2)

  let params2 = params1.delete("key1")
  assert_eq(params2.length(), 1)
}
```

### prop_pathparams_get_retrieves_set

Property: PathParams::get retrieves values that were set

```mbt check
///|
test "prop_pathparams_get_retrieves_set" {
  let params = PathParams::new()
    .set("id", "123")
    .set("name", "test")

  match params.get("id") {
    Some(v) => assert_eq(v, "123")
    None => assert_true(false, msg="should find id")
  }

  match params.get("name") {
    Some(v) => assert_eq(v, "test")
    None => assert_true(false, msg="should find name")
  }

  match params.get("missing") {
    Some(_) => assert_true(false, msg="should not find missing")
    None => ()
  }
}
```

### prop_pathparams_set_updates_existing

Property: PathParams::set updates existing keys (length-preserving)

```mbt check
///|
test "prop_pathparams_set_updates_existing" {
  let params1 = PathParams::new().set("key", "value1")
  assert_eq(params1.length(), 1)

  let params2 = params1.set("key", "value2")
  assert_eq(params2.length(), 1)

  match params2.get("key") {
    Some(v) => assert_eq(v, "value2")
    None => assert_true(false, msg="should find updated key")
  }
}
```

### prop_route_verb_matches

Property: Route::verb correctly identifies the HTTP method

```mbt check
///|
test "prop_route_verb_matches" {
  let get_route = Route::get("/test", fn(_req) { "<div>OK</div>" })
  assert_eq(get_route.verb(), GET)

  let post_route = Route::post("/submit", fn(_req) { "<div>Created</div>" })
  assert_eq(post_route.verb(), POST)

  let put_route = Route::put("/update", fn(_req) { "<div>Updated</div>" })
  assert_eq(put_route.verb(), PUT)

  let delete_route = Route::delete("/remove", fn(_req) { "<div>Deleted</div>" })
  assert_eq(delete_route.verb(), DELETE)

  let patch_route = Route::patch("/modify", fn(_req) { "<div>Patched</div>" })
  assert_eq(patch_route.verb(), PATCH)
}
```

### prop_route_path_preserved

Property: Route preserves the path pattern

```mbt check
///|
test "prop_route_path_preserved" {
  let path = "/users/:id/posts"
  let route = Route::get(path, fn(_req) { "<div>OK</div>" })

  assert_eq(route.path(), path)
}
```

### prop_path_normalization_removes_trailing_slash

Property: normalize_path removes trailing slashes

```mbt check
///|
test "prop_path_normalization_removes_trailing_slash" {
  // Assuming there's a normalize_path function
  // This test documents the expected behavior
  let paths = ["/users/", "/posts//", "/"]
  for i = 0; i < paths.length(); i = i + 1 {
    let p = paths[i]
    let normalized = p.split("/").filter(fn(s) { s != "" }).join("/")
    let result = if normalized == "" { "/" } else { "/" + normalized + "/" }
    assert_true(result.length() <= p.length(), msg="normalized should not be longer")
  }
}
```

### prop_pathparams_fold_iterates

Property: PathParams::fold iterates over all key-value pairs

```mbt check
///|
test "prop_pathparams_fold_iterates" {
  let params = PathParams::new()
    .set("a", "1")
    .set("b", "2")
    .set("c", "3")

  let count = params.fold(0, fn(acc, _key, _val) { acc + 1 })
  assert_eq(count, 3)
}
```
